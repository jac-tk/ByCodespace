<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWAapp</title>

    <!-- <link rel="manifest" id="mymanifest" /> -->
    <link rel="manifest" href="staticmani.json" />
</head>
<body>
    <div class="step1">
        input name<input type="text">
        <button onclick="generateEnv(this.previousElementSibling)">OK</button>
    </div>
    <div class="step2" style="display: none;">
        <span>CREATED!</span>
    </div>
</body>
<script>
    function generateEnv(elem){
        if(!elem.value)return alert("未入力！");
        const startUrl = window.location.href + "?" + elem.value,
                manifest = {
                    "name": "myPWAapplication",
                    "short_name": "myPWA",
                    "theme_color": "blue",
                    "background_color": "gray",
                    "display": "standalone",
                    "start_url": startUrl,
                    "icons": [
                        {
                        "src": "tst.png",
                        "sizes": "100x100"
                        }],
                    "screenshots": [
                        {
                        "src": "tst.png",
                        "sizes": "100x100"
                    }]
                    
                        
                }
        const stringManifest = JSON.stringify(manifest);
        const blob = new Blob([stringManifest], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        // document.querySelector('#mymanifest').setAttribute('href', manifestURL);

        document.querySelector(".step1").style.display="none"
        document.querySelector(".step2").style.display="unset"

        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("mysw.js");
        }

    }
</script>
</html>